<!DOCTYPE html>
<html lang="en">
  <!-- Mathjax Support -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      inlineMath: [['$','$']]
    }
  });
</script>
<script type="text/javascript" async
src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML">
</script>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  
  
  <title></title>
  <meta name="description" content="Learning by teaching">
  

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://dotkay.github.io/">
  
  
  <link rel="alternate" type="application/rss+xml" title="" href="https://dotkay.github.io/feed.xml">

  

  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:title" content="">
  <meta name="twitter:description" content="Learning by teaching">
  
  

  
  
  <script type="text/javascript">
  WebFontConfig = {
    google: { families: [ 'Bitter:400,700,400italic:latin' ] }
  };
  (function() {
    var wf = document.createElement('script');
    wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
      '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
  })();
</script>

  
  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-105390377-1', 'auto');
    ga('send', 'pageview');

  </script>


</head>


  <body>

    <header class="site-header">

  <div class="wrapper">
    <!-- Mathjax Support 
    <a class="site-title" href="/"></a> 
    -->
    <img src="/assets/images/dotk.png" width="50" height="30">
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/">About</a>
      
        
        <a class="page-link" href="/archives/">Posts</a>
      
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="home">

  

  

  <ul class="post-list">
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            <a class="post-link" href="/2021/09/22/stories-in-charts/">Stories in Charts &rarr;</a>
          </h1>

          <p class="post-meta">Sep 22, 2021 â€¢ 
  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/vaccination/">vaccination</a>,
    
  
    
  
    
  
    
  

  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/gdp/">gdp</a>,
    
  
    
  
    
  

  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/per-capita/">per-capita</a>,
    
  
    
  

  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/charts/">charts</a>,
    
  

  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/data-science/">data science</a>
    
  
    
  
    
  
    
  
    
  

</p>
        </header>

        <div class="post-content">
          <p>In this post, we will see the most ubiquitous, most useful and also the most easily mis-interpreted data visualization tools - <em>charts</em>. They come in various forms and they are used to represent different aspects of the underlying data. The key assumption is that the visual representation is easier to interpret quickly than in a tabular format. More often, one kind of story a chart conveys might hide another kind of story a different chart, of the underlying dataset, might have conveyed. It is not uncommon to find that the reader would interpret the chart in a way different from what the writer wanted to convey, in which case it is best for the writer to clarify the message being driven.</p>

<p>For example, let us look at the latest global vaccination data. When you look at the per-capita vaccination rates of different countries, and say you pick the top 50 countries, you would see a chart similar to the following (the chart below is from September, 2021). More specifically, the chart shows the number of fully vaccinated people per hundred of the population.</p>

<p><br /></p>
<div class="img_container">
  <center><img src="https://raw.githubusercontent.com/dotkay/data_science/master/plots/people_vax_per_100.png" /></center>
</div>

<p>What story does this tell? While per-capita numbers are a way to normalize the data, it crucially depends on the story that one wants to tell. Does this indicate the ease of availability of vaccines? Does it indicate the effectiveness of the healthcare system? Does this indicate the willingness of people to get the vaccine? Or something else?</p>

<p>Let us look at the absolute numbers for the same data and look at the chart.</p>

<p><br /></p>
<div class="img_container">
  <center><img src="https://raw.githubusercontent.com/dotkay/data_science/master/plots/people_vax.png" /></center>
</div>

<p><span style="color:gray; font-size: 50%; text-align: left;">
Data regarding fully vaccinated population from China was missing from the dataset and hence it does not show up in the chart. China had the most fully vaccinated population (absolute numbers) in September, 2021.
</span></p>

<p>We see a different picture. What story does this tell?</p>

<p>While both of the above charts convey useful information, it is necessary to understand what useful story could be told using the above. For example, the first chart (per-capita) could indicate what percentage of the total population is vaccinated. This could indicate to what extent the spread of the virus or hospitalizations could be contained and that very likely these countries could get out of the pandemic sooner and become safer to travel to. It does not indicate the effectiveness of the healthcare system or the challenges in getting more people vaccinated, etc.</p>

<p>The second chart shows the absolute number of people vaccinated in many countries. The difference between the two charts could show the challenges in getting the population vaccinated - it could be geographical as in some countries might be too large posing a logistics challenge, it could be the size of the population - even if enough vaccines are in supply more would be needed to get the entire population vaccinated or it could be a short supply of vaccines - again because of lack of storage or the price or a weak healthcare infrastructure.</p>

<p>On similar lines, when you look at GDP data and plot the top 50 countries by GDP the chart looks something like the following.</p>

<p><br /></p>
<div class="img_container">
  <center><img src="https://raw.githubusercontent.com/dotkay/data_science/master/plots/gdp_2018_top_50.png" /></center>
</div>
<p><span style="color:gray; font-size: 50%; text-align: left;">
The GDP numbers are from 2018 rather than latest numbers in order to avoid the variations of the effects of the pandemic on GDP.
</span></p>

<p>It shows the wealthiest countries (in terms of GDP). But does the wealth trickle down to every individual? Again, there might be challenges like population, management of funds, etc. Once you look at per-capita numbers one could see how different countries fare.</p>

<p><br /></p>
<div class="img_container">
  <center><img src="https://raw.githubusercontent.com/dotkay/data_science/master/plots/gdp_per_capita_2018_top_50.png" /></center>
</div>

<p>When you look at the GDP growth rate, it tells a different story - the countries that are improving from their past year. Yes, Libya did have 15% GDP growth in 2018.</p>

<p><br /></p>
<div class="img_container">
  <center><img src="https://raw.githubusercontent.com/dotkay/data_science/master/plots/gdp_growth_rate_2018.png" /></center>
</div>

<p>The chart we choose should depend on the story we want to tell. It is imperative to explicitly explain the choice of chart and how it tells the story the writer wants to tell and also the stories it does not.</p>

<p><span style="color:gray; font-size: 70%; text-align: left;">
The vaccination data used here is from a <a href="https://www.kaggle.com/gpreda/covid-world-vaccination-progress" target="_self">Kaggle dataset</a>.
</span></p>


        </div>
        
      </li>
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            <a class="post-link" href="/2021/08/16/stories-of-summer-olympics/">The Stories of Summer Olympics &rarr;</a>
          </h1>

          <p class="post-meta">Aug 16, 2021 â€¢ 
  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/olympics/">Olympics</a>,
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/medals/">medals</a>,
    
  
    
  
    
  
    
  
    
  
    
  

  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/data-science/">data science</a>
    
  
    
  
    
  
    
  
    
  

</p>
        </header>

        <div class="post-content">
          <p>This is about the stories of Summer Olympics - not just one story but many stories and not just the recently concluded Tokyo Olympics, but all of the Olympic games since the first one in Athens in 1896. Although the analysis of the medals won by different countries would make the story read like a story medals and achievements statistics, there are other stories hidden within. We will narrate many of those as we do the analysis.</p>

<p>We will use <code class="language-plaintext highlighter-rouge">pandas</code> library to do the data analysis and plotly to create our plots that would tell a visual story.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="n">px</span>
</code></pre></div></div>

<p>When we look at the hosts we see many western powers with Brazil and China (then emerging economies) hosting in 2008 and 2016 respectively. Of course, hosting an Olympics is no small thing - the infrastructure, safety, accessibility, etc. play a huge role and many of these cost money. London seems to be the only city that has hosted Olympics thrice.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">total_medals_by_host_city</span> <span class="o">=</span> <span class="n">summer_df</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'City'</span><span class="p">,</span> <span class="s">'Year'</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="bp">False</span><span class="p">)[</span><span class="s">'Medal'</span><span class="p">].</span><span class="n">count</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">total_medals_by_host_city</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'City'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'Medal'</span><span class="p">,</span>
            <span class="n">hover_data</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Medal'</span><span class="p">,</span> <span class="s">'Year'</span><span class="p">],</span> 
            <span class="n">color</span><span class="o">=</span><span class="s">'Medal'</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="s">'Medals Awarded at Each Venue'</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'London'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1690</span><span class="p">,</span>
        <span class="n">text</span><span class="o">=</span><span class="s">"London has hosted Olympics thrice..."</span><span class="p">,</span>
        <span class="p">...</span>
        <span class="p">...</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span>
<span class="p">)</span>

</code></pre></div></div>
<p>The number of events in each of the Olympics also seems to be different, as evidenced by the total number of medals awarded during the games. With Paris and London regularly competing for the best European City regularly I believe it is high time Paris got a chance to host the Summer Olympic games, and very glad 2024 Olympics are going to be held in Paris. I also hope more and more emerging economies to be able to host the games. The motivation and interest in sports such events would infuse is invaluable.</p>

<iframe id="igraph" scrolling="no" style="border:none;" seamless="seamless" src="https://plotly.com/~kkplot/17.embed" height="525" width="100%"></iframe>

<p>When we look at the cumulative number of medals won from the start of Summer Olympic games, USA clearly leads. But more important to note here is Russia which was more excellent in sports, science and technology, arts and culture, etc., when it was Soviet Union. Also interesting to note is the presence of an entry <em>Individual athletes</em> - athletes who chose to compete under the Olympic flag instead of any specific country. This is a political story.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">total_medals_by_country</span> <span class="o">=</span> <span class="n">summer_df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'Country'</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="bp">False</span><span class="p">)[</span><span class="s">'Medal'</span><span class="p">].</span><span class="n">count</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">total_medals_by_country</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'Country'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'Medal'</span><span class="p">,</span>
            <span class="n">hover_data</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Medal'</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'Medal'</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="s">'Cumulative Number of Medals Won (1896-2021)'</span><span class="p">)</span>
</code></pre></div></div>

<p>There were many instances where athletes who requested to compete independently and were refused - for example, the ones who emigrated from Communist Europe during the cold war, as well as some during the <a href="https://en.wikipedia.org/wiki/1976_Olympic_boycott">1976 Olympic boycott</a>. The first provisions were made by IOC (International Olympic Committee) during the 1980 Summer Olympics hosted at Moscow.</p>

<iframe id="igraph" scrolling="no" style="border:none;" seamless="seamless" align="middle" src="https://plotly.com/~kkplot/15.embed" height="600" width="1000"></iframe>

<p>When we look at the countries that shine on the top of the medals table regularly the familiar pattern is clear. It is mostly European countries, USA, Australia and more recently China. Although we might have cheered Usain Boltâ€™s sprints and track and field athletics being one of the most anticipated events of the Summer Olympic games, in terms of total number of medals, many western countries top the table year after year. This also indicates the broad variety and the number of events in the summer games.</p>

<p>There is also a political story hidden here, that of the 1980 Summer Olympics. There were only two cities that bid to host the games - Los Angeles and Moscow and eventually Moscow won. If you notice the 1980 Olympics that was hosted by Moscow, Russia seems to be the clear leader in terms of number of medals. Almost always, one expects host country to win several medals, but scoring more medals than the usual competitive powers is always a big achievement. Many nations boycotted the 1980 Olympics, led by the USA to protest against the Soviet-Afghan war. It had the smallest participation - just around 80 countries.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">top_n</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>
     <span class="n">df</span> 
    <span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">"Country"</span><span class="p">)</span>
    <span class="p">.</span><span class="n">agg</span><span class="p">({</span><span class="s">"Medal Count"</span><span class="p">:</span> <span class="s">"sum"</span><span class="p">})</span>
    <span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s">"Medal Count"</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">summer_df</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'Year'</span><span class="p">,</span> <span class="s">'Country'</span><span class="p">,</span> <span class="s">'Medal'</span><span class="p">]).</span><span class="n">size</span><span class="p">().</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Year'</span><span class="p">,</span> <span class="s">'Country'</span><span class="p">,</span> <span class="s">'Medal'</span><span class="p">,</span> <span class="s">'Medal Count'</span><span class="p">]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">"Country"</span><span class="p">].</span><span class="n">isin</span><span class="p">(</span><span class="n">top_n</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="n">index</span><span class="p">)],</span> 
             <span class="n">x</span><span class="o">=</span><span class="s">'Year'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'Medal Count'</span><span class="p">,</span>
            <span class="n">hover_data</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Country'</span><span class="p">,</span> <span class="s">'Medal Count'</span><span class="p">,</span> <span class="s">'Medal'</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="s">'Country'</span><span class="p">,</span> <span class="n">barmode</span><span class="o">=</span><span class="s">'stack'</span><span class="p">,</span>
            <span class="n">color_continuous_scale</span><span class="o">=</span><span class="n">px</span><span class="p">.</span><span class="n">colors</span><span class="p">.</span><span class="n">sequential</span><span class="p">.</span><span class="n">Viridis</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s">'Medal Winners in Olympics'</span><span class="p">)</span>
</code></pre></div></div>
<iframe id="igraph" scrolling="no" style="border:none;" seamless="seamless" src="https://plotly.com/~kkplot/19.embed" height="800" width="1000"></iframe>

<p>There are more politics stories in Olympics. The apparent gaps in the plot below makes one wonder what happened those years. The 1916 summer Olympics, to be hosted by Berlin, were cancelled due to World War I, a first cancellation in the 20 year history of Olympics during those days. The 1940 Olympics to be hosted by Tokyo were rescheduled to be hosted by Finland (due to Japanâ€™s invasion of China in 1937) and eventually cancelled due to the outbreak of World War II. Again, the 1944 Summer Olympics to be hosted by London got cancelled due to World War II. The 2020 Olympics hosted by Tokyo was rescheduled to 2021 due to the outbreak of Covid. It took tremendous courage and organization by Japan and the participating countries to put up a great show during the pandemic.</p>

<iframe id="igraph" scrolling="no" style="border:none;" seamless="seamless" src="https://plotly.com/~kkplot/21.embed" height="800" width="1000"></iframe>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_final</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">).</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">sort_values</span><span class="p">(</span><span class="n">idcols</span><span class="p">)</span>
                         <span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">idcols</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                         <span class="p">.</span><span class="n">cumsum</span><span class="p">()</span>
                         <span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s">'Cumulative Total Medals'</span><span class="p">})</span>
                         <span class="p">.</span><span class="n">reset_index</span><span class="p">()</span>
                         <span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dfnoc</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s">'NOC'</span><span class="p">)</span>
</code></pre></div></div>

<p>Now, to finish it off, let us see how the top 25 medal winners (measured as per medals won in 2020)
have fared over the years in terms of total medals won. The rise of China as a major sporting nation is very apparent.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">df_final</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_final</span><span class="p">[</span><span class="s">"Country"</span><span class="p">].</span><span class="n">isin</span><span class="p">(</span><span class="n">top_n</span><span class="p">(</span><span class="mi">25</span><span class="p">).</span><span class="n">index</span><span class="p">)],</span>
    <span class="n">x</span><span class="o">=</span><span class="s">"Country"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s">"Cumulative Total Medals"</span><span class="p">,</span>
    <span class="n">log_y</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="s">"Cumulative Total Medals"</span><span class="p">,</span>
    <span class="n">color_discrete_sequence</span><span class="o">=</span><span class="p">[</span><span class="s">"brown"</span><span class="p">,</span><span class="s">"gold"</span><span class="p">,</span><span class="s">"silver"</span><span class="p">],</span>
    <span class="n">color</span><span class="o">=</span><span class="s">"Medal"</span><span class="p">,</span>
    <span class="n">animation_frame</span><span class="o">=</span><span class="s">"Year"</span><span class="p">,</span>
    <span class="n">hover_name</span><span class="o">=</span><span class="s">"Country"</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s">"The Olympics Story"</span><span class="p">,</span>
<span class="p">)</span>

</code></pre></div></div>
<iframe id="igraph" scrolling="no" style="border:none;" seamless="seamless" src="https://plotly.com/~kkplot/24.embed" height="800" width="1100"></iframe>

<p><br />
<br /></p>

<p>While this short post tells several stories behind the Summer Olympics, I would like to write a future post on the stories behind Paralympics which will would be stories of courge, inspiration and extraordinary commitment.</p>

<p><br /></p>

<p><span style="color:gray; font-size: 70%; text-align: left;">
The data used here is from a <a href="https://www.kaggle.com/amirba/olympic-sports-and-medals-18962021" target="_self">Kaggle dataset</a>. This <a href="https://www.kaggle.com/heesoo37/120-years-of-olympic-history-athletes-and-results" target="_self">Kaggle dataset</a> was also used to get NOC (National Olympic Committee) codes of the different countries. Some of the numbers in the dataset does not seem to agree with tables in Wikipedia, nevertheless the differences are not huge to change the story.
</span></p>

        </div>
        
      </li>
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            <a class="post-link" href="/2021/06/06/us-youtube-views/">What have people been watching on YouTube? &rarr;</a>
          </h1>

          <p class="post-meta">Jun 6, 2021 â€¢ 
  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/us/">US</a>,
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/youtube/">YouTube</a>,
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/education/">Education</a>,
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/pandemic/">Pandemic</a>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

</p>
        </header>

        <div class="post-content">
          <p>For more than 15 months people around the world are mostly staying indoors, those who could are working from home, vacations and other outdoor entertainments have come to a standstill. At the same time, NetFlix, gaming, and other entertainment like TV and <a href="https://www.youtube.com/">YouTube</a> must have become more popular - after all, these are the forms of indoor entertainment. I decided to look at what people have been interested within this limited set of entertainment avenues. While I could not find most data, YouTube data was available and regularly updated. I decided to download the dataset that contains YouTube data from August 2020 until early June 2021. Let us see what people (in the U.S.) have been watching on YouTube during this period.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">yt_us</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'US_youtube_trending_data.csv'</span><span class="p">)</span>
<span class="n">yt_categories</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_json</span><span class="p">(</span><span class="s">'US_category_id.json'</span><span class="p">)</span>
<span class="n">yt_us</span><span class="p">.</span><span class="n">dtypes</span>
</code></pre></div></div>

<p>The different features in the dataset are (after casting <code class="language-plaintext highlighter-rouge">publishedAt</code> and <code class="language-plaintext highlighter-rouge">trending_date</code> to <code class="language-plaintext highlighter-rouge">datetime</code> type):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>video_id                          object
title                             object
publishedAt          datetime64[ns, UTC]
channelId                         object
channelTitle                      object
categoryId                        object
trending_date        datetime64[ns, UTC]
tags                              object
view_count                         int64
likes                              int64
dislikes                           int64
comment_count                      int64
thumbnail_link                    object
comments_disabled                   bool
ratings_disabled                    bool
description                       object
</code></pre></div></div>

<p>There are different categories of videos in the dataset, and these are the number of videos in each category.</p>

<p><br /></p>
<div class="img_container">
  <center><img src="https://raw.githubusercontent.com/dotkay/data_science/master/plots/n_cat_videos.png" /></center>
</div>

<p>I am surpised by the number of videos in some of the categories or the categorization itself. There is a category on <code class="language-plaintext highlighter-rouge">People &amp; Blogs</code> - I am not sure what it refers to. I do know artists have their own channels and YouTube is a more lively form of a blog, but there is also Music (some of the channels there might also be by music artists). While I try and understand how the different videos are categorized, let us look at some other stats.</p>

<p>Let us find out how many aggregate views each of the different categories has:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cat_view_count_df</span> <span class="o">=</span> <span class="n">yt_us</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'categoryId'</span><span class="p">])[</span><span class="s">'view_count'</span><span class="p">].</span><span class="n">agg</span><span class="p">([</span><span class="s">'sum'</span><span class="p">])</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">cat_view_count_df</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s">'categoryId'</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s">'view_count'</span><span class="p">,</span>
        <span class="n">palette</span><span class="o">=</span><span class="s">'Set2'</span><span class="p">,</span>
        <span class="n">order</span><span class="o">=</span><span class="n">cat_view_count_df</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'view_count'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">category</span>
<span class="p">)</span>
</code></pre></div></div>
<p><br /></p>
<div class="img_container">
  <center><img src="https://raw.githubusercontent.com/dotkay/data_science/master/plots/nviews_cat_videos.png" /></center>
</div>

<p>Not surprisingly, Music, Entertainment and Gaming are right at the top. Unfortunately, Education category is way behind. I find YouTube as a wonderful source of education. But may be this is due to Coursera, Udacity, etc. having their own video encoders and decoders and do not have their content on YouTube.</p>

<p>Let us see which were the Top 50 most viewed videos during the time period, in the U.S.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># create a new column 'count_max_view' to collect max view_count
</span><span class="n">yt_us</span><span class="p">[</span><span class="s">'count_max_view'</span><span class="p">]</span> <span class="o">=</span> <span class="n">yt_us</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'video_id'</span><span class="p">])[</span><span class="s">'view_count'</span><span class="p">].</span><span class="n">transform</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span>
<span class="c1"># sort the column so that we can pick out the top 50
</span><span class="n">top50</span> <span class="o">=</span> <span class="n">yt_us</span><span class="p">[</span><span class="n">yt_us</span><span class="p">[</span><span class="s">'view_count'</span><span class="p">]</span> <span class="o">==</span> <span class="n">yt_us</span><span class="p">[</span><span class="s">'count_max_view'</span><span class="p">]].</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s">'count_max_view'</span><span class="p">],</span> 
                                                                          <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">head</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="c1"># remove non alpha-numeric characters from the titles
</span><span class="n">top50</span><span class="p">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">top50</span><span class="p">.</span><span class="n">title</span><span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'[^a-zA-Z0-9]'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
</code></pre></div></div>

<p>And let us plot the dataset to see which ones are on the top:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">catplot</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">top50</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="s">'title'</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="s">'view_count'</span><span class="p">,</span>
            <span class="n">kind</span><span class="o">=</span><span class="s">'bar'</span><span class="p">,</span>
            <span class="n">palette</span><span class="o">=</span><span class="s">'muted'</span><span class="p">,</span>
            <span class="n">aspect</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">legend</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
</code></pre></div></div>
<p><br /></p>
<div class="img_container">
  <center><img src="https://raw.githubusercontent.com/dotkay/data_science/master/plots/top50_yt_videos.png" /></center>
</div>

<p>Since I am fond of Education, I would like to see which YouTube channels have maxinum number of views and check if any of my favourite channels appear in the list.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">yt_edu</span> <span class="o">=</span> <span class="n">yt_us</span><span class="p">[</span><span class="n">yt_us</span><span class="p">[</span><span class="s">'categoryId'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'Education'</span><span class="p">]</span>
<span class="n">yt_edu</span> <span class="o">=</span> <span class="n">yt_edu</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'channelTitle'</span><span class="p">])[</span><span class="s">'view_count'</span><span class="p">].</span><span class="n">agg</span><span class="p">([</span><span class="s">'sum'</span><span class="p">])</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">yt_edu</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s">'channelTitle'</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s">'view_count'</span><span class="p">,</span>
        <span class="n">palette</span><span class="o">=</span><span class="s">'Set2'</span><span class="p">,</span>
        <span class="n">order</span><span class="o">=</span><span class="n">yt_edu</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'view_count'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">channelTitle</span>
<span class="p">)</span>
</code></pre></div></div>

<p><br /></p>
<div class="img_container">
  <center><img src="https://raw.githubusercontent.com/dotkay/data_science/master/plots/yt_edu_views.png" /></center>
</div>

<p>I see a lot of interesting channels - Khan Academy seems to have just made it to the list. I also see a channel <code class="language-plaintext highlighter-rouge">YouTube</code>. I see lots of interesting channel names and I hope to spend more time exploring those on YouTube very soon.</p>

<p>The <a href="https://www.kaggle.com/rsrishav/youtube-trending-video-dataset">YouTube dataset</a> is also available for other geographies. Someday, I would like to compare how the interests in different geographies differ by comparing YouTube channelsâ€™ popularity. It may not be an accurate representation of interests at all, but it should be a fun exercise.</p>

        </div>
        
      </li>
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            <a class="post-link" href="/2021/03/15/us-job-loss-and-recovery/">U.S. - Job Losses and Recovery &rarr;</a>
          </h1>

          <p class="post-meta">Mar 15, 2021 â€¢ 
  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/us/">US</a>,
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/labor-market/">labor market</a>,
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/economy/">economy</a>,
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/pandemic/">pandemic</a>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

</p>
        </header>

        <div class="post-content">
          <p>In a <a href="https://dotkay.github.io/2021/02/21/us-unemployment">previous post</a>, we saw how many jobs the different states in the U.S. have lost over the years primarily due to trade deficits. In this post, we will visually analyze the <a href="https://www.bls.gov/charts/employment-situation/employment-levels-by-industry.htm">data from BLS</a> and compare the effects of 2008 recession and the ongoing pandemic on the state of employment in the U.S. across different sectors.</p>

<p>The covid-19 pandemic has definitely wrecked the employment across several sectors of the labor economy and not just the hospitality sector. If we look at the employment numbers for an year starting from January 2020, job losses are evident. We also see the quick recovery (though not to January-2020 levels) in several of the sectors.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">job_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Manufacturing Jobs'</span><span class="p">,</span> <span class="s">'Hospitality Jobs'</span><span class="p">,</span> <span class="s">'Wholesale Jobs'</span><span class="p">,</span>
       <span class="s">'Retail Jobs'</span><span class="p">,</span> <span class="s">'Transportation Jobs'</span><span class="p">,</span> <span class="s">'Construction Jobs'</span><span class="p">,</span>
       <span class="s">'Education Health Services Jobs'</span><span class="p">,</span> <span class="s">'Finance Jobs'</span><span class="p">,</span> <span class="s">'Information Jobs'</span><span class="p">,</span>
       <span class="s">'Mining Jobs'</span><span class="p">,</span> <span class="s">'Other Services Jobs'</span><span class="p">,</span> <span class="s">'Professional Services Jobs'</span><span class="p">,</span>
       <span class="s">'Utilities Jobs'</span><span class="p">]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="n">area</span><span class="p">(</span><span class="n">pandemic_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"Month"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">job_cols</span><span class="p">,</span> 
              <span class="n">template</span><span class="o">=</span><span class="s">'simple_white'</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="n">add_annotation</span><span class="p">(...)</span>
<span class="p">...</span>
<span class="n">fig</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<iframe id="igraph" scrolling="yes" style="border:none;" seamless="seamless" src="https://plotly.com/~kkplot/10.embed" height="700" width="980"></iframe>

<p>If we zoom out in the data set and look at two decades of employment numbers all the way from January 2001 until January 2021, we also see the effect of 2008 recession on employment numbers. We also see how gradual and prolonged the effect of 2008 recession was. The job losses across sectors during the pandemic was sudden and steep and the recovery of numbers was also quick.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="n">area</span><span class="p">(</span><span class="n">emp_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"Month"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">job_cols</span><span class="p">,</span> 
                   <span class="n">template</span><span class="o">=</span><span class="s">'simple_white'</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="n">add_annotation</span><span class="p">(...)</span>
<span class="p">...</span>
<span class="n">fig</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<iframe id="igraph" scrolling="yes" style="border:none;" seamless="seamless" src="https://plotly.com/~kkplot/12.embed" height="700" width="980"></iframe>

<p>We can just hope that the recovery from the pandemic continues quicker and reaches early 2020 levels, not only in the U.S. but across the globe. Given that the world is very globalized today than ever before, anyone is healthy and good only when everyone is healthy and good.</p>

<p><span style="font-size: 70%">
<i>The tabular BLS data was parsed using BeautifulSoup, and the plots were done using plotly and chart_studio.</i>
</span></p>

        </div>
        
      </li>
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            <a class="post-link" href="/2021/02/21/us-unemployment/">Jobs, Offshoring and Unemployment - US &rarr;</a>
          </h1>

          <p class="post-meta">Feb 21, 2021 â€¢ 
  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/us/">US</a>,
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/labor-market/">labor market</a>,
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <a href="/categories/economy/">economy</a>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  

</p>
        </header>

        <div class="post-content">
          <p>With 2020 being one of the worst in recent history, for many reasons fuelled by the pandemic. With many countries being unprepared to handle a pandemic of this size, it also exposed the global supply chain being <a href="https://dotkay.github.io/2020/04/01/efficiency-vs-flexibility">highly optimized rather than flexible</a>. It also exposed the inequality in society - healthcare, job security, income, etc. Many countries had to start manufacturing personal protective equipments (PPE), ventilators, etc. by themselves to serve the local needs rather than rely on the supply chain that got stalled. A couple of decades ago, many of these equipments were manufactured locally but over time, many of those got offshored.</p>

<p>However, this post is not about unemployment due to the pandemic. It is more about loss of U.S. jobs over the period 2001-2017, mostly due to trade deficits, with data from <a href="https://www.epi.org/publication/the-china-toll-deepens-growth-in-the-bilateral-trade-deficit-between-2001-and-2017-cost-3-4-million-u-s-jobs-with-losses-in-every-state-and-congressional-district/">this report</a> and manufacturing data from <a href="https://www.bls.gov/charts/employment-situation/employment-levels-by-industry.htm">BLS data</a>.</p>

<p>The first decade of the century was the worst for U.S. manufacturing jobs. It saw the steepest decline in such jobs, in a very long time. There are two conflicting theories around this - one argues the loss is due to increased automation, while the other attributes the loss to offshoring of such jobs. I could not find the data on rate of automation or increase in manufacturing jobs in other geographies during the time period in order to analyze it analytically. However the loss of jobs, whatever being the root cause, is itself staggering.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="n">px</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">emp_df</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s">'Month'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'Manufacturing Jobs'</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'Manufacturing Jobs'</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="nb">dict</span><span class="p">({</span><span class="s">'Manufacturing Jobs'</span><span class="p">:</span><span class="s">'Manufacturing Jobs (in thousands)'</span><span class="p">}),</span>
            <span class="n">template</span><span class="o">=</span><span class="s">'simple_white'</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">autosize</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">700</span>
<span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<iframe id="igraph" scrolling="yes" style="border:none;" seamless="seamless" src="https://plotly.com/~kkplot/6.embed" height="700" width="100%"></iframe>

<p>Apparently, about four decades ago the Bay Area in California was full of orange orchards, and a couple of decades later they all became startups working in electronics and software (Silicon Valley). They were not startups making apps that let teenagers poke and swipe at each other but advanced electronics and software that goes along with it, like routers, modems, semiconductor chips, etc. There were supposedly many small enterprises manufacturing circuit boards and assembling systems for these famous companies.</p>

<p>An old video of Macintosh Factory in Fremont:
<br /></p>
<div class="img_container">
  <iframe width="560" height="315" src="https://www.youtube.com/embed/Dk306ZkNOuc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
</div>

<p>But does it mean only the electronics jobs got offshored? Not really. If we look at the data deeper and look at the number of jobs lost state-wise, it gives a more detailed picture. Almost every major state in the U.S. has lost thousands of jobs from 2001-2017, with most of the loss happening between 2001-2009. Many other states would have seen loss of jobs in other industries like automobiles and steel included.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'State'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'Jobs Lost'</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'% Jobs Lost'</span><span class="p">,</span>
             <span class="n">labels</span><span class="o">=</span><span class="nb">dict</span><span class="p">({</span><span class="s">'Jobs Lost'</span><span class="p">:</span><span class="s">'Jobs Lost (in thousands)'</span><span class="p">}))</span>
<span class="n">fig</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<iframe id="igraph" scrolling="yes" style="border:none;" seamless="seamless" src="https://plotly.com/~kkplot/1.embed" height="600" width="980"></iframe>

<p>If we look even deeper into the data, we can see how many jobs were lost in each stateâ€™s congressional districts.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'Total Jobs'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'State'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'% Jobs Lost'</span><span class="p">,</span>
             <span class="n">labels</span><span class="o">=</span><span class="nb">dict</span><span class="p">({</span><span class="s">'State'</span><span class="p">:</span><span class="s">'States and Congressional Districts'</span><span class="p">}),</span>
             <span class="n">hover_name</span><span class="o">=</span><span class="s">'Congressional District'</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<iframe id="igraph" scrolling="yes" style="border:none;" seamless="seamless" src="https://plotly.com/~kkplot/4.embed" height="870" width="100%"></iframe>

<p>When I find reliable data on rate of automation and manufacturing jobs gained in other geographies, analysis of that data would help in putting the pieces together. While I am not against offshoring, I am all for a more flexible supply chain, rather than a super-optimized supply chain that would get disrupted affecting the lives and livelihoods of several people, as we witnessed last year when medical devices and PPE supply chain got disrupted.</p>

<p>While many jobs have been offshored causing large scale unemployment, there is still hope for reskilling of workers and creating new jobs that would drive the economy the next two decades - like solar panels, <a href="https://dotkay.github.io/2020/09/13/electric-batteries">electric batteries</a>, recycling of batteries, advanced technologies for water, air purification, education and healthcare, etc.</p>

<p><span style="font-size: 70%">
<i>The tabular data from EPI report was parsed using BeautifulSoup, and the plots were done using plotly and chart_studio.</i>
</span></p>

        </div>
        
      </li>
    
  </ul>

  
  <div class="pagination">
    
      <a class="previous" href="/posts/2/">&laquo; Older</a>
    

    
  </div>



</div>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <p>
      

&copy;  - Powered by <a href="https://jekyllrb.com">Jekyll</a> &amp; <a href="https://github.com/yous/whiteglass">whiteglass</a> - Subscribe via <a href="https://dotkay.github.io/feed.xml">RSS</a>

    </p>

  </div>

</footer>


  </body>

</html>
